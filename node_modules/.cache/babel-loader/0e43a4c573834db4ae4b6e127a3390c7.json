{"ast":null,"code":"import _classPrivateFieldLooseBase from \"/home/aziyatali/Desktop/IV-Leaflet/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classPrivateFieldLooseBase\";\nimport _classPrivateFieldLooseKey from \"/home/aziyatali/Desktop/IV-Leaflet/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classPrivateFieldLooseKey\";\nimport papa from \"papaparse\";\nimport legendItems from \"../entities/LegendItems\";\nimport { features } from \"../data/countries.json\";\nconsole.log(features);\n\nvar _processCovidData = _classPrivateFieldLooseKey(\"processCovidData\");\n\nvar _setCountryColor = _classPrivateFieldLooseKey(\"setCountryColor\");\n\nvar _formatNumberWithCommas = _classPrivateFieldLooseKey(\"formatNumberWithCommas\");\n\nclass LoadCountryTask {\n  constructor() {\n    this.covidUrl = \"https://raw.githubusercontent.com/aziyatali/IV-Leaflet/main/src/data/owid-covid-data.csv\";\n    this.setState = null;\n\n    this.load = setState => {\n      this.setState = setState;\n      papa.parse(this.covidUrl, {\n        download: true,\n        header: true,\n        complete: result => _classPrivateFieldLooseBase(this, _processCovidData)[_processCovidData](result.data)\n      });\n    };\n\n    Object.defineProperty(this, _processCovidData, {\n      writable: true,\n      value: covidCountries => {\n        console.log(\"parsed data: \", covidCountries);\n\n        for (let i = 0; i < covidCountries.length; i++) {\n          const country = covidCountries[i];\n\n          if (i === 0) {\n            console.log(\"data: \", country.date);\n          } //console.log(country);\n\n\n          const covidCountry = covidCountries.find(covidCountry => country.properties.ISO_A3 === covidCountry.iso_code); //console.log(\"covid_country: \", covidCountry);\n\n          country.properties.confirmed = 0;\n          country.properties.confirmedText = 0;\n\n          if (covidCountry != null) {\n            let confirmed = Number(covidCountry.total_cases); // console.log(\"CASE: \", confirmed);\n\n            country.properties.confirmed = confirmed;\n            country.properties.confirmedText = _classPrivateFieldLooseBase(this, _formatNumberWithCommas)[_formatNumberWithCommas](confirmed);\n          }\n\n          _classPrivateFieldLooseBase(this, _setCountryColor)[_setCountryColor](country);\n        }\n\n        this.setState(features);\n      }\n    });\n    Object.defineProperty(this, _setCountryColor, {\n      writable: true,\n      value: country => {\n        const legendItem = legendItems.find(item => item.isFor(country.properties.confirmed));\n        if (legendItem != null) country.properties.color = legendItem.color;\n      }\n    });\n    Object.defineProperty(this, _formatNumberWithCommas, {\n      writable: true,\n      value: number => {\n        return number.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n      }\n    });\n  }\n\n}\n\nexport default LoadCountryTask;","map":{"version":3,"sources":["/home/aziyatali/Desktop/IV-Leaflet/src/tasks/LoadCountriesTask.js"],"names":["papa","legendItems","features","console","log","LoadCountryTask","covidUrl","setState","load","parse","download","header","complete","result","data","covidCountries","i","length","country","date","covidCountry","find","properties","ISO_A3","iso_code","confirmed","confirmedText","Number","total_cases","legendItem","item","isFor","color","number","toString","replace"],"mappings":";;AAAA,OAAOA,IAAP,MAAiB,WAAjB;AACA,OAAOC,WAAP,MAAwB,yBAAxB;AACA,SAASC,QAAT,QAAyB,wBAAzB;AACAC,OAAO,CAACC,GAAR,CAAYF,QAAZ;;;;;;;;AACA,MAAMG,eAAN,CAAsB;AAAA;AAAA,SACpBC,QADoB,GACT,0FADS;AAAA,SAGpBC,QAHoB,GAGT,IAHS;;AAAA,SAKpBC,IALoB,GAKZD,QAAD,IAAc;AACnB,WAAKA,QAAL,GAAgBA,QAAhB;AACAP,MAAAA,IAAI,CAACS,KAAL,CAAW,KAAKH,QAAhB,EAA0B;AACxBI,QAAAA,QAAQ,EAAE,IADc;AAExBC,QAAAA,MAAM,EAAE,IAFgB;AAGxBC,QAAAA,QAAQ,EAAGC,MAAD,gCAAY,IAAZ,wCAAmCA,MAAM,CAACC,IAA1C;AAHc,OAA1B;AAKD,KAZmB;;AAAA;AAAA;AAAA,aAcCC,cAAD,IAAoB;AACtCZ,QAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ,EAA6BW,cAA7B;;AACA,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,cAAc,CAACE,MAAnC,EAA2CD,CAAC,EAA5C,EAAgD;AAC9C,gBAAME,OAAO,GAAGH,cAAc,CAACC,CAAD,CAA9B;;AACA,cAAIA,CAAC,KAAK,CAAV,EAAY;AACVb,YAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBc,OAAO,CAACC,IAA9B;AACD,WAJ6C,CAK9C;;;AACA,gBAAMC,YAAY,GAAGL,cAAc,CAACM,IAAf,CAClBD,YAAD,IAAkBF,OAAO,CAACI,UAAR,CAAmBC,MAAnB,KAA8BH,YAAY,CAACI,QAD1C,CAArB,CAN8C,CAS9C;;AAEAN,UAAAA,OAAO,CAACI,UAAR,CAAmBG,SAAnB,GAA+B,CAA/B;AACAP,UAAAA,OAAO,CAACI,UAAR,CAAmBI,aAAnB,GAAmC,CAAnC;;AAEA,cAAIN,YAAY,IAAI,IAApB,EAA0B;AACxB,gBAAIK,SAAS,GAAGE,MAAM,CAACP,YAAY,CAACQ,WAAd,CAAtB,CADwB,CAExB;;AACAV,YAAAA,OAAO,CAACI,UAAR,CAAmBG,SAAnB,GAA+BA,SAA/B;AACAP,YAAAA,OAAO,CAACI,UAAR,CAAmBI,aAAnB,+BAAmC,IAAnC,oDACED,SADF;AAGD;;AACD,gFAAsBP,OAAtB;AACD;;AAED,aAAKX,QAAL,CAAcL,QAAd;AACD;AA1CmB;AAAA;AAAA;AAAA,aA4CAgB,OAAD,IAAa;AAC9B,cAAMW,UAAU,GAAG5B,WAAW,CAACoB,IAAZ,CAAkBS,IAAD,IAClCA,IAAI,CAACC,KAAL,CAAWb,OAAO,CAACI,UAAR,CAAmBG,SAA9B,CADiB,CAAnB;AAIA,YAAII,UAAU,IAAI,IAAlB,EAAwBX,OAAO,CAACI,UAAR,CAAmBU,KAAnB,GAA2BH,UAAU,CAACG,KAAtC;AACzB;AAlDmB;AAAA;AAAA;AAAA,aAoDOC,MAAD,IAAY;AACpC,eAAOA,MAAM,CAACC,QAAP,GAAkBC,OAAlB,CAA0B,uBAA1B,EAAmD,GAAnD,CAAP;AACD;AAtDmB;AAAA;;AAAA;;AAyDtB,eAAe9B,eAAf","sourcesContent":["import papa from \"papaparse\";\nimport legendItems from \"../entities/LegendItems\";\nimport { features } from \"../data/countries.json\";\nconsole.log(features);\nclass LoadCountryTask {\n  covidUrl = \"https://raw.githubusercontent.com/aziyatali/IV-Leaflet/main/src/data/owid-covid-data.csv\";\n   \n  setState = null;\n\n  load = (setState) => {\n    this.setState = setState;\n    papa.parse(this.covidUrl, {\n      download: true,\n      header: true,\n      complete: (result) => this.#processCovidData(result.data),\n    });\n  };\n\n  #processCovidData = (covidCountries) => {\n    console.log(\"parsed data: \", covidCountries);\n    for (let i = 0; i < covidCountries.length; i++) {\n      const country = covidCountries[i];\n      if (i === 0){\n        console.log(\"data: \", country.date);\n      }\n      //console.log(country);\n      const covidCountry = covidCountries.find(\n        (covidCountry) => country.properties.ISO_A3 === covidCountry.iso_code\n      );\n      //console.log(\"covid_country: \", covidCountry);\n\n      country.properties.confirmed = 0;\n      country.properties.confirmedText = 0;\n\n      if (covidCountry != null) {\n        let confirmed = Number(covidCountry.total_cases);\n        // console.log(\"CASE: \", confirmed);\n        country.properties.confirmed = confirmed;\n        country.properties.confirmedText = this.#formatNumberWithCommas(\n          confirmed\n        );\n      }\n      this.#setCountryColor(country);\n    }\n\n    this.setState(features);\n  };\n\n  #setCountryColor = (country) => {\n    const legendItem = legendItems.find((item) =>\n      item.isFor(country.properties.confirmed)\n    );\n\n    if (legendItem != null) country.properties.color = legendItem.color;\n  };\n\n  #formatNumberWithCommas = (number) => {\n    return number.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n  };\n}\n\nexport default LoadCountryTask;\n"]},"metadata":{},"sourceType":"module"}